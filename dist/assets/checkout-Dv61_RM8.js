import{g as r,c,b as l,l as n,s as h}from"./utils-DAaM6Wbz.js";import{E as u}from"./ExternalServices-C23S5ejd.js";const p=new u;class d{constructor(e,t){this.key=e,this.outputSelector=t,this.list=[],this.itemTotal=0,this.shipping=0,this.tax=0,this.orderTotal=0}init(){this.list=r(this.key),this.calculateOrderTotal()}calculateOrderTotal(){this.calculateItemSubTotal(),this.tax=parseFloat((this.itemTotal*.06).toFixed(2)),this.calculateShippingCost(),this.orderTotal=this.itemTotal+this.tax+this.shipping,this.orderTotal=this.orderTotal.toFixed(2),this.tax=this.tax.toFixed(2),this.displayOrderTotals()}calculateItemSubTotal(){this.itemTotal=parseFloat(this.list.reduce((e,t)=>e+t.ListPrice,0).toFixed(2))}calculateShippingCost(){for(let e=0;e<this.list.length;e++)e==0?this.shipping+=10:this.shipping+=2;this.shipping=parseFloat(this.shipping.toFixed(2))}displayOrderTotals(){document.querySelector(`${this.outputSelector}#subtotal`).innerText=`$${this.itemTotal.toFixed(2)}`,document.querySelector(`${this.outputSelector}#taxes`).innerText=`$${this.tax}`,document.querySelector(`${this.outputSelector}#shipping`).innerText=`$${this.shipping.toFixed(2)}`,document.querySelector(`${this.outputSelector}#total`).innerText=`$${this.orderTotal}`}async checkout(){const e=document.forms.checkout,t=m(e);t.orderDate=new Date().toISOString(),t.orderTotal=this.orderTotal,t.tax=this.tax,t.shipping=this.shipping,t.items=g(this.list),console.log(t);try{const o=await p.checkout(t);console.log(o),c(),window.location.replace("/checkout/success.html")}catch(o){console.log(o),l("Please review the fields and try again.")}}}function m(i){const e=new FormData(i),t={};return e.forEach((o,a)=>{t[a]=o}),t}function g(i){return i.map(t=>(console.log(t),{id:t.Id,price:t.FinalPrice,name:t.Name,quantity:1}))}const s=new d("so-cart","");s.init();async function T(){await n(),h()}T();document.querySelector("#checkout-submit").addEventListener("click",i=>{i.preventDefault();const e=document.forms[0],t=e.checkValidity();e.reportValidity(),t&&s.checkout()});
