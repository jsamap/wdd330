import{g as a,c,l,s as n}from"./utils-BbxnfwaP.js";import{E as h}from"./ExternalServices-C23S5ejd.js";const u=new h;class p{constructor(e,t){this.key=e,this.outputSelector=t,this.list=[],this.itemTotal=0,this.shipping=0,this.tax=0,this.orderTotal=0}init(){this.list=a(this.key),this.calculateOrderTotal()}calculateOrderTotal(){this.calculateItemSubTotal(),this.tax=parseFloat((this.itemTotal*.06).toFixed(2)),this.calculateShippingCost(),this.orderTotal=this.itemTotal+this.tax+this.shipping,this.orderTotal=this.orderTotal.toFixed(2),this.tax=this.tax.toFixed(2),this.displayOrderTotals()}calculateItemSubTotal(){this.itemTotal=parseFloat(this.list.reduce((e,t)=>e+t.ListPrice,0).toFixed(2))}calculateShippingCost(){for(let e=0;e<this.list.length;e++)e==0?this.shipping+=10:this.shipping+=2;this.shipping=parseFloat(this.shipping.toFixed(2))}displayOrderTotals(){document.querySelector(`${this.outputSelector}#subtotal`).innerText=`$${this.itemTotal.toFixed(2)}`,document.querySelector(`${this.outputSelector}#taxes`).innerText=`$${this.tax}`,document.querySelector(`${this.outputSelector}#shipping`).innerText=`$${this.shipping.toFixed(2)}`,document.querySelector(`${this.outputSelector}#total`).innerText=`$${this.orderTotal}`}async checkout(){const e=document.forms.checkout,t=d(e);t.orderDate=new Date().toISOString(),t.orderTotal=this.orderTotal,t.tax=this.tax,t.shipping=this.shipping,t.items=m(this.list),console.log(t);try{const o=await u.checkout(t);console.log(o),c(),window.location.href="checkout/success.html"}catch(o){console.log(o)}}}function d(i){const e=new FormData(i),t={};return e.forEach((o,r)=>{t[r]=o}),t}function m(i){return i.map(t=>(console.log(t),{id:t.Id,price:t.FinalPrice,name:t.Name,quantity:1}))}const s=new p("so-cart","");s.init();async function T(){await l(),n()}T();document.querySelector("#checkout-submit").addEventListener("click",i=>{i.preventDefault();const e=document.forms[0],t=e.checkValidity();e.reportValidity(),t&&s.checkout()});
