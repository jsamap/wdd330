import{g as a,l as c,s as l}from"./utils-6aLUDPX2.js";import{E as n}from"./ExternalServices-D9P6I627.js";const h=new n;class u{constructor(e,t){this.key=e,this.outputSelector=t,this.list=[],this.itemTotal=0,this.shipping=0,this.tax=0,this.orderTotal=0}init(){this.list=a(this.key),this.calculateOrderTotal()}calculateOrderTotal(){this.calculateItemSubTotal(),this.tax=parseFloat((this.itemTotal*.06).toFixed(2)),this.calculateShippingCost(),this.orderTotal=this.itemTotal+this.tax+this.shipping,this.orderTotal=this.orderTotal.toFixed(2),this.tax=this.tax.toFixed(2),this.displayOrderTotals()}calculateItemSubTotal(){this.itemTotal=parseFloat(this.list.reduce((e,t)=>e+t.ListPrice,0).toFixed(2))}calculateShippingCost(){for(let e=0;e<this.list.length;e++)e==0?this.shipping+=10:this.shipping+=2;this.shipping=parseFloat(this.shipping.toFixed(2))}displayOrderTotals(){document.querySelector(`${this.outputSelector}#subtotal`).innerText=`$${this.itemTotal.toFixed(2)}`,document.querySelector(`${this.outputSelector}#taxes`).innerText=`$${this.tax}`,document.querySelector(`${this.outputSelector}#shipping`).innerText=`$${this.shipping.toFixed(2)}`,document.querySelector(`${this.outputSelector}#total`).innerText=`$${this.orderTotal}`}async checkout(){const e=document.forms.checkout,t=p(e);t.orderDate=new Date().toISOString(),t.orderTotal=this.orderTotal,t.tax=this.tax,t.shipping=this.shipping,t.items=d(this.list),console.log(t);try{const o=await h.checkout(t);console.log(o)}catch(o){console.log(o)}}}function p(i){const e=new FormData(i),t={};return e.forEach((o,r)=>{t[r]=o}),t}function d(i){return i.map(t=>(console.log(t),{id:t.Id,price:t.FinalPrice,name:t.Name,quantity:1}))}const s=new u("so-cart","");s.init();async function m(){await c(),l()}m();document.querySelector("#checkout-submit").addEventListener("click",i=>{i.preventDefault(),s.checkout()});
